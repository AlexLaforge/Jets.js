/*! Jets.js - v0.7.0 - 2016-03-16
* http://NeXTs.github.com/Jets.js/
* Copyright (c) 2015 Denis Lukov; Licensed MIT */

!function(t,e){"undefined"!=typeof module?module.exports=e():"function"==typeof define&&"object"==typeof define.amd?define(e):t.Jets=e()}(this,function(){"use strict";function t(e){if(!(this instanceof t))return new t(e);var n=this;["searchTag","contentTag"].forEach(function(t){var o=t.replace("Tag",""),r="querySelector"+("contentTag"==t?"All":"");if(n[o+"_tag"]=document[r](e[t]),n[o+"_param"]=e[t],!n[o+"_tag"])throw new Error("Error! Could not find "+t+" element")});var o={searchSelector:"*AND",diacriticsMap:{}};if(n.options={},["columns","addImportant","searchSelector","manualContentHandling","diacriticsMap","didSearch","invert"].forEach(function(t){n.options[t]=e[t]||o[t]}),this.options.searchSelector.length>1){var r=n.options.searchSelector.trim();n.options.searchSelector=r.substr(0,1),n.options.searchSelectorMode=r.substr(1).toUpperCase()}var i,s=function(){i!=(i=n.search_tag.value)&&(n._applyCSS(),n.options.didSearch&&n.options.didSearch(n.search_tag.value))};n._onSearch=function(t){return"keydown"==t.type?setTimeout(s,0):void s()},n.destroy=function(){n._processEventListeners("remove"),n._destroy()},n._processEventListeners("add"),n._addStyleTag(),n._setJets(),n._applyCSS()}return t.prototype={constructor:t,_processEventListeners:function(t){["input","keydown","change"].forEach(function(e){this.search_tag[t+"EventListener"](e,this._onSearch)}.bind(this))},_applyCSS:function(){for(var t=this.replaceDiacritics(this.search_tag.value.trim().toLowerCase().replace(/\s\s+/g," ")),e=this.options.searchSelectorMode?t.split(" ").filter(function(t,e,n){return n.indexOf(t)==e}):[t],n="AND"==this.options.searchSelectorMode,o=[],r=0,i=e.length;i>r;r++)o.push((n?this.content_param+">":"")+(this.options.invert?"":":not(")+"[data-jets"+this.options.searchSelector+'="'+e[r]+'"]'+(this.options.invert?"":")"));var s=(n?"":this.content_param+">")+o.join(n?",":"")+"{display:none"+(this.options.addImportant?"!important":"")+"}";this.styleTag.innerHTML=t.length?s:""},_addStyleTag:function(){this.styleTag=document.createElement("style"),document.head.appendChild(this.styleTag)},_getText:function(t){return t&&(t.textContent||t.innerText)||""},_getContentTags:function(t){return Array.prototype.slice.call(this.content_tag).reduce(function(e,n){return e.concat(Array.prototype.slice.call(n.querySelectorAll(t||":scope > *")))},[])},_setJets:function(t,e){for(var n,o,r=this,i=r._getContentTags(e?"":t),s=0;o=i[s];s++)(!o.hasAttribute("data-jets")||e)&&(n=this.options.manualContentHandling?this.options.manualContentHandling(o):r.options.columns&&r.options.columns.length?r.options.columns.map(function(t){return r._getText(o.children[t])}).join(" "):r._getText(o),o.setAttribute("data-jets",r.replaceDiacritics(n.trim().replace(/\s+/g," ").toLowerCase())))},replaceDiacritics:function(t){var e=this.options.diacriticsMap;for(var n in e)if(e.hasOwnProperty(n))for(var o=0,r=e[n].length;r>o;o++)t=t.replace(new RegExp(e[n][o],"g"),n);return t},update:function(t){this._setJets(":scope > :not([data-jets])",t)},_destroy:function(){this.styleTag.parentNode&&document.head.removeChild(this.styleTag);for(var t,e=this._getContentTags(),n=0;t=e[n];n++)t.removeAttribute("data-jets")}},function(t,e){try{t.querySelector(":scope body")}catch(n){["querySelector","querySelectorAll"].forEach(function(n){var o=e[n];e[n]=function(e){if(/(^|,)\s*:scope/.test(e)){var r=this.id;this.id="ID_"+Date.now(),e=e.replace(/((^|,)\s*):scope/g,"$1#"+this.id);var i=t[n](e);return this.id=r,i}return o.call(this,e)}})}}(window.document,Element.prototype),t});
